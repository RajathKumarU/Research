Authentication Failures in NIST version of GCMtitlerpIn this note, we study the security of the Galois/Counter mode authenticated encryption recently published by NIST. We show how an adversary can recover the secret key of the keyed hash function underlying the authentication, using a chosenIV attack.Once this secret key is known, the encryption mode is no longer authenticated. As a consequence, all chosen ciphertext attacks against the confidentialitybecome feasible. Moreover, since the encryption mode is a counter mode, i.e. a stream cipher,theXOR malleability of the encryptedplaintextbecomes a major security issue.abstractrp keywordsrpRecently, the National Institute of Standard and Technology has published several recommend modes of operation for use with the AES block cipher.Thefourth recommendationinthis series[2] describes an authenticated encryption modebased on aproposal ofMcGrew andViegra[4]. The goal of this recommendation is to provide a very efficient mode of operation, that performs a single block cipher invocation per message block and does not need access to block cipher decryption even when decrypting messages.Thelatterpropertyis very useful,from aperformance point of view, when using a substitution permutation algorithm such as theAES.Indeed, when using theAESimplementingboth encryption and decryption is costly and avoiding decryption altogether is a worthy goal. Thisissuehasnot attracted much attentioninthepast,sincewithFeistel schemes such asDES,decryptionisjust encryption with the order of the subkey reversed. Still, when performing encryption without authentication, a well-known solution exist: the counter mode.
However,the counter modedoes notoffer thelevel of security expected nowadayfor encryption mode.Indeed,itis only designed to resist chosen
plaintext attack. The Galois/Counter mode (GCM) proposed by NIST in[2]followsthe classicalencrypt-then-MAC approachin ordertoturnthe counter mode into a encryption scheme secure against chosen-ciphertext adversaries.
In order to cover a wide range of application, GCM also allows the authentication of some associated data sendin the clear together with the encrypted message. TheMAC used in GCM loosely follows theWegmanCarterparadigmfrom[5], akeyedhashis computed and an encrypted copy of the hash value is added to the ciphertext to provide authentication. Since GCM is based on a counter mode, it requires an initialization vector denoted by IV. The default length of the IV is 96 bits, however, for added flexibility GCM allows the use of IVs of different length and for a given key the length of the IV does not even need to be fixed. It is widely known that replaying an IV in a counter mode voids the confidentiality of all messages encrypted with this IV. As a consequence, it is specified in GCM that IVs should never be repeated. Nevertheless, in ordertointroduceourattacksagainstsNIST versionofGCM,we firstdescribea“forbiddenattack”involving arepeatedIV.Thisforbiddenattack is mainly proposed for illustration purposes.
Thepaperis organized asfollows:in section2 we recall thedescription of theGalois/Counter mode,in section3 wepresenttheforbiddenattack with repeated IVs, in section 4 we study the security of the mechanism which allows the use of an IV of length different than the default (96 bits) andpresenttwo attacks againstthis mechanism asdescribedin[2]. Finally, since our attacks allow the adversary to learn the authentication key, we recall in section 5 the security implications.introductionrpIn this paper, we have shown an important attack of the NIST version GCM mode. This stems from the fact that GCM excessively relies on the hypothesis that IVs are never repeating. Moreover, the modification introduced by NIST turns this fact into a effective attack when variable length IVs are used.conclusionrp1.
M. Bellare and C. Namprempre. Authenticated encryption: relations among notions and analysis of the generic composition paradigm. In Springer-Verlag, editor, Proceedings of Asiacrypt 2000, 2000.
2.
M. Dworkin. Recommendation for block cipher modes of operation: Gcm for confidentiality and authentication. NIST special publication 800-38D, April 2006.
3.
N. Ferguson. Authentication weaknesses in gcm. NIST web page http://csrc.nist.gov/CryptoToolKit/modes/comments, May 2005.
4.
D. McGrew and J. Viegra. The security and performance of the Galois/Counter mode.InSpringer-Verlag, editor, Proceedings of INDOCRYPT’04,2004. Fullpaper available on eprint, report 2004/193.
5.
M.WegmanandL.Carter.Newhashfunctionsand theiruseinauthenticationand set equality. J. of Comp. and System Sciences, 22:265–279, 1981.referencesrp